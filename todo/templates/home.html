{% extends 'base.html' %}

{% block body %}

<div class="row">
	<div class="col-md-9 col-md-offset-1">
		<h2>Welcome, {{ user.first_name }}! <br/>
			<small>Today is {% now "F d, Y" %}.</small>
		</h2>

		<form class="form-horizontal" method="POST" action="/home/new_item">
			<input class="form-control" type="text" id="new_item_text" name="new_item_text" placeholder="New To-Do" autofocus />
			{% csrf_token %}
		</form>

		<div class="panel panel-primary" id="item_list">
			<div class="panel-heading">
				<span class="panel-title">To-Do</span>
			</div>
			<div class="panel-body" id="item_list">
				<form method="POST" role="form" id="todo">
					{% for item in items %}
						<div class="input-group voffset1 todo_item" id="item-{{item.id}}">
							<span class="input-group-addon">
								<input type="checkbox" value="{{item.id}}" class="toggle_complete"
									{% if item.completed %} checked {% endif %}>
							</span>
							<span class="item_text form-control">
								{{ item.text }}
							</span>
							<span class="input-group-btn">
								<button type="button" class="btn btn-default">&#x2715;</button>
						</div>
					{% endfor %}
				</form>
			</div>
		</div>
	</div>
	<div class="col-md-2 col-md-pull-1 voffset3">
		<a href="/logout" id="logout" class="btn btn-info">Log-out</a>
	</div>
</div>

<script language="javascript" type="text/javascript">
$('#todo input:checkbox').change(function() {
	$.ajaxSetup({data: {csrfmiddlewaretoken: '{{ csrf_token }}' },});
  $.post("/home/toggle_complete_item", {item_id : $(this).val()});
});
</script>

{% endblock %}